PROCEDURE      GUI_MAIN.CASE_VALIDATE:T  (157591,51546)  |Last amended Apr 03, 2014,14:19:06
subprocedure CASE_VALIDATE   |   CASE_TEMP_VALUE MUST BE PASSED IN
C note, I'm not sure where the case id is going to be, either the new id field or the search field or a hidden field.  Who knows right now.
<COMMENT> WRITE 'Sub: CASE_VALIDATE: ' CASE_TEMP_VALUE
. PROCEED = NO
. if(exists(CASE_TEMP_VALUE) EQ 0) display infobox 'Sorry, no ' + CASE_NAME + ' was specified.'; exit subprocedure
. if(len(CASE_TEMP_VALUE) EQ 0) display infobox 'Opps, ' + CASE_NAME + ' is blank.'; exit subprocedure
. ifthen (meminfo('NAVIGATE2.CXID:O',1) = MEM_O)
.   execute subroutine SIR014.NAVIGATE2.CXID (CASE_TEMP_VALUE) returning (PROCEED) DYNAMIC
.   ifthen (PROCEED <> 1)
.     display infobox 'This ID is not valid'
.     EXIT SUBPROCEDURE
.   endif
. endif
. ifthen (meminfo('NAVIGATE2.IDACCESS:O',1) = MEM_O)
.   execute subroutine SIR014.NAVIGATE2.IDACCESS (CASE_TEMP_VALUE) returning (PROCEED) DYNAMIC
.   ifthen (PROCEED <> 1)
.     display infobox 'Sorry, access is limited.'
.     EXIT SUBPROCEDURE
.   endif
. endif
. VAL_VAR = validate(0,CASE_NAME, CASE_TEMP_VALUE)
. ifthen (VAL_VAR eq 0) | valid value
.   PROCEED = YES
. else
.   display infobox 'Sorry, ' + CASE_TEMP_VALUE +', is not a valid value for ' + CASE_NAME
. endif
end subprocedure
END PROCEDURE
